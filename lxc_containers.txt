Install lxc

$ sudo apt-get install lxc

LXC and networking:

$ sudo brctl show

To see an IP address assigned to the lxcbr0

$ sudo ifconfig lxcbr0

To see DHCP range used by containers

$ ps aux | grep lxc-dns | grep -o 'dhcp-range.[0-9].* '

To check the current kernel for lxc support:

$ lxc-checkconfig


Step – 1: Create a new user for lxc

$ sudo useradd -s /bin/bash -c 'unprivileged lxc user' -m mylxc

mylxc is the username 

Step – 2: Set password for for lxc

$ sudo passwd mylxc

Step -3: Find out allocated subuids and subgids for the lxc user

$ sudo grep mylxc /etc/sub{gid,uid}

Note down the values.

Step – 4:Create a default container configuration file for lxc user

$ sudo vi /etc/lxc/lxc-usernet

Append the following line:

mylxc veth lxcbr0 10

Save and Close file

switch to new user using su or just login using the ssh client:

$ su - mylxc

Once logged into a remote machine, type the following command to create ~/.config/lxc/ director as follows:

$ mkdir -p ~/.config/lxc

Finally, create ~/.config/lxc/default.conf file as follows:

$ cp /etc/lxc/default.conf ~/.config/lxc/default.conf

Edit the file, enter:

$ vi ~/.config/lxc/default.conf

Append the configuration as follows (use mapped user and group id ranges 100000:65536 from step #3):

lxc.id_map = u 0 100000 65536
lxc.id_map = g 0 100000 65536


Step – 5:Create a new container

SYNTAX: $ lxc-create -t download -n {container-name-here} -- -d {DISTRONAME} -r {RELEASE} -a {ARCH}

$ sudo lxc-create -t download -n httpd -- -d ubuntu -r trusty -a amd64

If Error Comes: 
Open file

$ sudo nano /etc/sudoers

Then add the user below admin user like below syntax.

user_name ALL=(ALL)  ALL

Step – 6:Start a new container

To start httpd container type:

$ sudo lxc-start -n httpd -d
$ echo $?
$ sudo lxc-ls --fancy

To start a process inside a running container or just to login, enter:

$ sudo lxc-attach -n httpd

Sample session inside a httpd container:

mylxc@lakshmi-HP:~$ sudo lxc-attach -n httpd
root@httpd:/# id
uid=0(root) gid=0(root) groups=0(root)
root@httpd:/# ifconfig
eth0      Link encap:Ethernet  HWaddr 00:16:3e:19:02:ab  
          inet addr:10.0.3.141  Bcast:10.0.3.255  Mask:255.255.255.0
          inet6 addr: fe80::216:3eff:fe19:2ab/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:77 errors:0 dropped:0 overruns:0 frame:0
          TX packets:49 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:9505 (9.5 KB)  TX bytes:4670 (4.6 KB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

root@httpd:/# lsb_release -a
No LSB modules are available.
Distributor ID:	Ubuntu
Description:	Ubuntu 14.04.6 LTS
Release:	14.04
Codename:	trusty



For security reason, container images ship without user accounts and without a root password. Setup a root password for httpd container:
# passwd root

To enable sshd for httpd container, run:
# apt-get install openssh-server

exit

You can login from host to container using ssh:
$ ssh user@10.0.3.255

How do I stop a container?
$ lxc-stop {container-name-here}

How do I destroy (delete) a container?
$ lxc-delete {container-name-here}

How do I list all containers?
$ lxc list -cns
$ lxc-ls
$ lxc-ls --fancy

How do I update or patch my container?
Use the lxc-attach command to update your container that is powered by Ubuntu or Debian:
$ sudo lxc-attach -n <container-name> apt-get -- -qq update
$ sudo lxc-attach -n <container-name> apt-get -- -qq upgrade
$ sudo lxc-attach -n <container-name> yum -- -y update

Setting CPU limit:
$ sudo lxc config set <CONTAINER> limits.cpu [VALUE]

Memory:
To apply a straightforward memory limit run:

$ sudo lxc config set <container> limits.memory [VALUE]

To set a disk limit (requires btrfs or ZFS):

$ sudo lxc config device override <container> root size=[VALUE]



















